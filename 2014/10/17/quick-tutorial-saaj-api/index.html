
<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.53" />

    
    
    

<title>A quick tutorial on SAAJ API • A Morsel Of Code</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A quick tutorial on SAAJ API"/>
<meta name="twitter:description" content="We ran into an issue last week. I had to call a third party web service that was built in PHP. Anyone who wokrs with Java will tell you that calling a web service is not more 15 minutes coding. You take the wsdl, run wsdl2Java command from Axis2 and start calling the service.
Like I said before, things are never so straightforward. No matter what version of Axis or CXF we used, we kept getting this error:"/>

<meta property="og:title" content="A quick tutorial on SAAJ API" />
<meta property="og:description" content="We ran into an issue last week. I had to call a third party web service that was built in PHP. Anyone who wokrs with Java will tell you that calling a web service is not more 15 minutes coding. You take the wsdl, run wsdl2Java command from Axis2 and start calling the service.
Like I said before, things are never so straightforward. No matter what version of Axis or CXF we used, we kept getting this error:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2014/10/17/quick-tutorial-saaj-api/" /><meta property="article:published_time" content="2014-10-17T20:28:07&#43;00:00"/>
<meta property="article:modified_time" content="2014-10-17T20:28:07&#43;00:00"/>



<link rel="canonical" href="/2014/10/17/quick-tutorial-saaj-api/" />

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">





<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">

<link rel="stylesheet" href="/css/w3.css" />


<link rel="stylesheet" href="/css/style.css" />









  
  
</head>
<body }

class="w3-light-grey">


    
    <header id="header">
         
        <div class="w3-right ">
<div class="w3-bar w3-light-grey  ">
  
  <span class="w3-bar-item w3-left " id="google_translate_element"></span>
<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement(
      {
          pageLanguage: 'en'
        , layout: google.translate.TranslateElement.FloatPosition.TOP_RIGHT
        , multilanguagePage: true
      }
      , 'google_translate_element'
    );
  }
</script>
<script async src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>


  
       <a href="javascript:void(0)" class="w3-bar-item w3-button w3-hover-green" title="Search" onclick="displaysearch()"><i class="fa fa-search"></i></a>
  
      <span class="w3-hide-small">
        
        <a href="mailto:dinesh19aug@gmail.com" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-envelope"></i></a>
        
        <a href="https://stackoverflow.com/users/1172194/dinesh-arora" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-stack-overflow"></i></a>
        
        <a href="https://twitter.com/dinesh19aug" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-twitter"></i></a>
        
        <a href="https://github.com/dinesh19aug" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-github"></i></a>
        
        <a href="https://www.linkedin.com/in/dinesharora" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-linkedin"></i></a>
        
        <a href="https://github.com/dinesh19aug" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-github"></i></a>

      </span>
  
</div>
</div>
<br>
  <div class="w3-content">
  
  <div class="w3-container w3-center w3-padding-32 w3-hide-small"> 
      <h1 class="w3-xxxlarge w3-text-blue w3-wide w3-allerta  " style="text-shadow:1px 1px 0 #444" ><u>
      
         A Morsel Of Code - One Byte At A Time
      
</u></h1>
      
    </div>
    <div class="w3-content w3-center">
    <div class="w3-bar w3-light-grey w3-border">
    <a href="/" class="w3-bar-item w3-button w3-large w3-green"><i class="fa fa-home"></i></a>
    
      <a href="/categories/" class="w3-bar-item w3-button w3-hide-small">Categories</a>
    
      <a href="/tags/" class="w3-bar-item w3-button w3-hide-small">Tags</a>
    
   
    
    <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="displaymenu()">&#9776;</a>
  </div>

<div id="mobilemenu" class="w3-bar-block w3-light-grey w3-hide w3-hide-large w3-hide-medium">
  
      <a href="/categories/" class="w3-bar-item w3-button">Categories</a>
      
      <a href="/tags/" class="w3-bar-item w3-button">Tags</a>
      
  
</div>
</div>
</div>
<script>
function displaymenu() {
    var x = document.getElementById("mobilemenu");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>



  <div id="searchOverlay" class="overlay w3-hide">
    <span class="closebtn" onclick="displaysearch()" title="Close Overlay">×</span>
    <div class="overlay-content">
        <form action="/search/">
          <input type="text" placeholder="Search.." name="q">
          <button type="submit"><i class="fa fa-search"></i></button>
        </form>
    </div>
  </div>

  <script>
  function displaysearch() {
    var x = document.getElementById("searchOverlay");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
      
  }

 
  </script>

  


    
    <hr class="headfoot">
   
      
    </header>
    
<div class="w3-content">
    
      <div>
        <div id="content" >
          
    

 
     


  <div class="w3-content w3-card-4" >
    
    <header class="w3-container w3-center w3-padding-32">
      <h1>A quick tutorial on SAAJ API</h1>

      <div >
        <p> 2014-10-17 
          
             <code> 873 words  </code>
             <code> 5 mins read </code>
          
        </p>
        <div >
            
              <a class="w3-btn w3-small w3-round w3-green" href="/categories/tech-notes/"> Tech Notes </a>
            
          </div>
       
        
      </div>
    </header>

   
    
    <div class="w3-container">
      
        

        
        

        
          
          
          <p>We ran into an issue last week. I had to call a third party web service that was built in PHP. Anyone who wokrs with Java will tell you that calling a web service is not more 15 minutes coding. You take the wsdl, run wsdl2Java command from Axis2 and start calling the service.</p>

<p>Like I said before, things are never so straightforward. No matter what version of Axis or CXF we used, we kept getting this error:</p>

<blockquote>
<p>Caused by: org.apache.axiom.soap.SOAPProcessingException: Transport level information does not match with SOAP Message namespace URI</p>

<p>at org.apache.axis2.builder.BuilderUtil.validateSOAPVersion(BuilderUtil.java:772)</p>

<p>at org.apache.axis2.builder.SOAPBuilder.processDocument(SOAPBuilder.java:58)</p>

<p>at org.apache.axis2.transport.TransportUtils.createDocumentElement(TransportUtils.java:179)</p>

<p>at org.apache.axis2.transport.TransportUtils.createSOAPMessage(TransportUtils.java:145)</p>

<p>at org.apache.axis2.transport.TransportUtils.createSOAPMessage(TransportUtils.java:108)</p>

<p>&#8230; 13 more</p>
</blockquote>

<p>Now what this usually means is that client and server are using different version of SOAP(1.1 vs 1.2). For a long time my colleague tried to look for a solution on various forums, blogs etc. and everyone confirmed the same that the issue is at the service provider end. However, the same service was being used by 20 other vendors without an issue. Our Canada office reported that they were able to call the service without any issue albeit in PHP(OOPS!!).</p>

<p>One fine afternoon it just struck me that Axis, CXF etc. are nothing but a wrapper around Java&#8217;s SAAJ API. Imagine how did developers call services before Axis and CXF? They coded QNAME, SOAPMessage manually! Lo and Behold but I went down to &#8230; let&#8217;s call it low level programming because I had to write code for all the XML node element, define namespaces etc.. which was not fun at all.</p>

<p>So this tutorial will walk you through basics of SAAJ, how and when to use the SAAJ API.</p>

<p><strong>WHY DO I NEED SAAJ over AXIS2 or CXF?</strong></p>

<p>I so badly want to say that when you want to avoid the above error, use SAAJ :-). SAAJ is helpfule when you want complete control over SOAP elements. For example if you need to change name spaces or modify soap message attributes then SAAj comes in handy.</p>

<p>A typical SOAP message looks like this</p>

<p><img class="alignnone size-full wp-image-743" src="/placeholder.svg" data-src="http://javahabit.com/wp-content/uploads/2014/10/img_544163699fb361.png" alt="" /></p>

<p>As you can see SAAJ provides <em>SOAPMessage, SOAPHeader, SOAPBody</em> classes to capture the message. When you create a new SOAPMessage object, it will automatically have the parts that are required to be in a SOAP message. In other words, a new SOAPMessage object has a SOAPPart object that contains a SOAPEnvelope object. The SOAPEnvelope object in turn automatically contains an empty SOAPHeader object followed by an empty SOAPBody object. If you do not need the SOAPHeader object, which is optional, you can delete it. The rationale for having it automatically included is that more often than not you will need it, so it is more convenient to have it provided. The SOAPHeader object may contain one or more headers with information about the sending and receiving parties. The SOAPBody object, which always follows the SOAPHeader object if there is one, provides a simple way to send information intended for the ultimate recipient. For example, if there is a SOAPFault object, it must be in the SOAPBody object.</p>

<p>So If have a service where I need the request SOAP Message should look like</p>

<blockquote>
<p><soapenv:Envelope xmlns:soapenv=&#8221;http://schemas.xmlsoap.org/soap/envelope/&#8221; xmlns:urn=&#8221;urn:http://com.mycompany.IamDoingSomething&#8221;></p>

<p><a href="soapenv:Header/">soapenv:Header/</a></p>

<p><a href="soapenv:Body">soapenv:Body</a></p>

<p><a href="urn:getPresaleByAddress">urn:getPresaleByAddress</a></p>

<p><stnum>123</p>

<p><stnumsuff></stnumsuff></p>

<p><stnam>Forest</stnam></p>

<p><sttyp>DR</sttyp></p>

<p><stdir></stdir></p>

<p><loctypa></loctypa></p>

<p><locnuma></locnuma></p>

<p><loctypb></loctypb></p>

<p><locnumb></locnumb></p>

<p><muni>OTTAWA</muni></p>

<p><post>K1A1A1</post></p>

<p><prov>on</prov></p>

<p><!--<span class="hiddenSpellError" pre="" data-mce-bogus="1"-->urn:getPresaleByAddress&gt;</p>

<p><!--<span class="hiddenSpellError" pre="" data-mce-bogus="1"-->soapenv:Body&gt;</p>

<p><!--<span class="hiddenSpellError" pre="" data-mce-bogus="1"-->soapenv:Envelope&gt;</p>
</blockquote>

<p>and I need to send this message to web service url &#8220;<a href="http://some-webservice-url.com&amp;#8221">http://some-webservice-url.com&amp;#8221</a>;</p>

<p><strong>STEPS</strong></p>

<ol>
<li>Create a SOAP Message</li>
</ol>

<blockquote>
<p>MessageFactory factory = MessageFactory.newInstance();</p>

<p>SOAPMessage message = factory.createMessage();</p>
</blockquote>

<p>&nbsp;</p>

<p>Result:</p>

<blockquote>
<p>xmlns:SOAP-ENV=&#8221;<a href="http://schemas.xmlsoap.org/soap/envelope/&amp;#8221;&gt;">http://schemas.xmlsoap.org/soap/envelope/&amp;#8221;&gt;</a></p>

<p><a href="SOAP-ENV:Header/">SOAP-ENV:Header/</a></p>

<p><a href="SOAP-ENV:Body/">SOAP-ENV:Body/</a></p>

<p><a href="/SOAP-ENV:Envelope">/SOAP-ENV:Envelope</a></p>
</blockquote>

<ol>
<li>Access Soap parts or message</li>
</ol>

<blockquote>
<p>SOAPHeader header = message.getSOAPHeader();</p>

<p>SOAPBody body = message.getSOAPBody();</p>
</blockquote>

<p>&nbsp;</p>

<ol>
<li>Add Message Content</li>
</ol>

<blockquote>
<p> SOAPBody body = message.getSOAPBody();</p>

<p>SOAPFactory soapFactory = SOAPFactory.newInstance();</p>

<p>Name bodyName = soapFactory.createName(&#8220;getPresaleByAddress&#8221;,&#8221;urn&#8221;, &#8220;<a href="http://com.mycompany.IamDoingSomething&amp;#8221;">http://com.mycompany.IamDoingSomething&amp;#8221;</a>);</p>

<p>SOAPBodyElement bodyElement = body.addBodyElement(bodyName);</p>
</blockquote>

<p>Result:</p>

<blockquote>
<p><a href="urn:getPresaleByAddress">urn:getPresaleByAddress</a></p>

<p>&#8230;</p>

<p><!--<span class="hiddenSpellError" pre="" data-mce-bogus="1"-->urn:getPresaleByAddress&gt;</p>
</blockquote>

<ol>
<li>Add Message Headers namespaces if Any</li>
</ol>

<blockquote>
<p>MimeHeaders headers = soapMessage.getMimeHeaders();</p>

<p>headers.addHeader(&#8220;SOAPAction&#8221;, leonidUrl+ &#8220;/getPresaleByAddress&#8221;);</p>

<p>SOAPPart soapPart = soapMessage.getSOAPPart();</p>

<p>// SOAP Envelope</p>

<p>SOAPEnvelope envelope = soapPart.getEnvelope();</p>

<p>envelope.addNamespaceDeclaration(&#8220;urn&#8221;, &#8220;urn:<a href="http://com.mycompany.IamDoingSomething&amp;#8221;">http://com.mycompany.IamDoingSomething&amp;#8221;</a>);</p>
</blockquote>

<p>&nbsp;</p>

<ol>
<li>Add Basic Authentication if any</li>
</ol>

<blockquote>
<p>String authorization = new sun.misc.BASE64Encoder().encode((&#8220;myUserName&#8221;+&#8221;:&#8221;+&#8221;myPassword&#8221;).getBytes());</p>

<p>headers.addHeader(&#8220;Authorization&#8221;, &#8220;Basic &#8221; + authorization);</p>
</blockquote>

<ol>
<li>Add child elements</li>
</ol>

<blockquote>
<p>QName bodyName = new QName(&#8220;urn:<a href="http://com.mycompany.IamDoingSomething&amp;#8221;,&amp;#8221;getPresaleByAddress&amp;#8221;,&amp;#8221;urn&amp;#8221;">http://com.mycompany.IamDoingSomething&amp;#8221;,&amp;#8221;getPresaleByAddress&amp;#8221;,&amp;#8221;urn&amp;#8221;</a>) ;</p>

<p>SOAPBodyElement bodyElement = body.addBodyElement(bodyName);</p>

<p>QName node_name = new QName(qName);</p>

<p>SOAPElement node_element = null;</p>

<p>try {</p>

<p>node_element = bodyElement.addChildElement(&#8220;stnum&#8221;);</p>

<p>if(hasNodeValue){</p>

<p>node_element.addTextNode(&#8220;123&#8221;);</p>

<p>}</p>

<p>}</p>
</blockquote>

<p>Result:</p>

<blockquote>
<p><stnum>123</stnum></p>
</blockquote>

<ol>
<li>Get a Soap Connection Object</li>
</ol>

<blockquote>
<p>SOAPConnectionFactory soapConnectionFactory = SOAPConnectionFactory.newInstance();</p>

<p>SOAPConnection connection = soapConnectionFactory.createConnection();</p>

<p>&nbsp;</p>
</blockquote>

<p>SOAP messages are sent and received over a connection. This connection is represented by a SOAPConnection object, which goes from the sender directly to its destination. This kind of connection is called a point-to-point connection because it goes from one endpoint to another endpoint. Messages sent using the SAAJ API are called request-response messages. They are sent over a SOAPConnection object with the method call, which sends a message (a request) and then blocks until it receives the reply (a response).</p>

<ol>
<li>Send the message</li>
</ol>

<blockquote>
<p>// Create an endpoint point which is either URL or String type</p>

<p>java.net.URL endpoint = new URL(&#8220;<a href="http://some-webservice-url.com&amp;#8221;">http://some-webservice-url.com&amp;#8221;</a>);</p>

<p>// Send a SOAPMessage (request) and then wait for SOAPMessage (response)</p>

<p>SOAPMessage response = connection.call(message, endpoint);</p>
</blockquote>

<ol>
<li>Print the SOAP Response XML</li>
</ol>

<blockquote>
<p>Transformer transformer = transformerFactory.newTransformer();</p>

<p>Source sourceContent = response.getSOAPPart().getContent();</p>

<p>ByteArrayOutputStream outputStream = new ByteArrayOutputStream();</p>

<p>StreamResult result = new StreamResult(outputStream);</p>

<p>transformer.transform(sourceContent, result);</p>

<p>log.info(&#8220;nResponse SOAP Message ::n {}&#8221; , result.getOutputStream().toString());</p>
</blockquote>

<p>That&#8217;s it!!</p>

<p>There are many other things that you can do with SAAJ. To read more about SAAJ and it&#8217;s capabilities you can read <a title="here" href="http://docs.oracle.com/javaee/5/tutorial/doc/bnbhg.html" target="_blank">here</a> and <a title="here" href="http://java.boot.by/wsd-guide/ch05s04.html" target="_blank">here</a></p>

<p>&nbsp;</p>

<p>~Ciao</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

                 
                
         
      
    </div>

    
   

    <div class="w3-container">
    	
      
     
	</div>



  


    
    
    
    
    <br>  
</div>



<div class="w3-container w3-card-2 w3-black">
<div class="w3-row">
  <div class="w3-col l2 m2 s12 w3-center">
  
    <img src="https://avatars3.githubusercontent.com/u/1176242?s=460&amp;v=4" width ="100px" class="w3-circle w3-center w3-margin-top w3-margin-bottom" alt="author" >
   
  </div>
  <div class="w3-col l10 m10 s12 ">
  <div class = "w3-container w3-margin-top">
    
    
  </div>
  </div>
  </div>
</div>

      
    <div class="w3-content" > 
      <div class="w3-bar w3-section">
	     
	      <a  href="/2015/01/26/restful-webservice-7-steps-using-spring-boot/" class="w3-btn w3-text-indigo w3-hover-green">
	          &#10094; Restful Webservice in 7 Steps using Spring boot
	      </a>
	    
	      <a class="w3-btn w3-right w3-text-indigo w3-hover-green" href="/2014/04/18/apache-poi-tutorial-reading-writing-excel-files-java/">
	       Read / Write Excel file in Java using Apache POI &#10095;
	      </a>
  	  </div>
    </div>
	
 

  
  
  

      <div id="wrapads">
        <div class="adBanner">
         
        </div>
       </div>
      
      <div id="allowads" class="allowads-overlay">
  
        <div class="allowads-overlay-content">
        <div class="w3-panel w3-pink w3-large">
        

         <p> We notice you're using an adblocker.  If you like our webite please keep us running by whitelisting this site in your ad blocker. We’re serving quality, related ads only. Thank you!</p>
         
          <div class="w3-btn w3-green"  onclick="closeOverlay()">I've whitelisted your website.</div><br>
          <div class="w3-button w3-small"  onclick="closeOverlay()">Not now</div>
        </div>
        </div>
      </div>

      <script>
      function closeOverlay() {
        document.getElementById("allowads").style.width = "0%";
        document.getElementById("wrapads").style.height="1px";
      }

      function detectads() {
      var h = document.getElementById("wrapads").clientHeight;

      if (h==0){ document.getElementById("allowads").style.width = "100%";
      }
      }
      

     
      
      </script>
        </div>
        
          <script>
  shareurl=encodeURIComponent(location.protocol + '//' + location.host + location.pathname);
  sharetitle=encodeURIComponent(document.title);
    
  </script>
<div class="icon-bar">
<script>
document.write( '<a href="javascript:bookmark();" class="bookmark w3-tooltip"><i class="fa fa-bookmark"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green ">Bookmark this page</span></a> ');

document.write( '<a href="http://www.facebook.com/sharer.php?u='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="facebook w3-tooltip"><i class="fa fa-facebook "></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Facebook</span></a> ');

document.write( '<a href="https://twitter.com/share?url='+shareurl+'&amp;text='+sharetitle+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="twitter w3-tooltip"><i class="fa fa-twitter"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Twitter</span></a> ');
document.write( '<a href="https://plus.google.com/share?url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="google w3-tooltip"><i class="fa fa-google"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Google Plus</span></a>');

document.write( '<a href="http://www.linkedin.com/shareArticle?mini=true&amp;url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="linkedin w3-tooltip"><i class="fa fa-linkedin"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Linkedin</span></a>');

</script>

<script>
function bookmark(){

if ('sidebar' in window && 'addPanel' in window.sidebar) { 
                window.sidebar.addPanel(location.href,document.title,"");
            } else if(  false) { 
                window.external.AddFavorite(location.href,document.title); 
            } else { 
                alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
            }
        }

</script>
</div>
        
           
          
  

        
        
      </div>
    

   
    <footer id="footer" >
      <div class="w3-container w3-center w3-padding-32"> 
  
  <hr class="headfoot">
  <p>Powered by <a href="https://gohugo.io">Hugo</a> | Theme - <a href="https://github.com/jesselau76/hugo-w3-simple">Hugo W3 Simple</a>
  </p>
  &copy; <a href="http://javahabit.com">Dinesh Arora</a> 2019 | <a href="https://github.com/dinesh19aug">Github</a> | <a href="https://twitter.com/dinesh19aug">Twitter</a>  | <a href="/index.xml">RSS</a>
  
</div>

    </footer>
    

    
  </div>

  

  
    
      <div id="backtotop" class="w3-hide-small w3-hide-medium">
  
        <button onclick="topFunction()" class="w3-btn w3-red w3-large" style="width:160px">Back To Top
        &rarr;</button>
        
      </div>

      <script>
        function topFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
      }
      </script>


    
 
    
    <script>
    
    function isVisible(elem) {

      let coords = elem.getBoundingClientRect();

      let windowHeight = document.documentElement.clientHeight;

      
      let topVisible = coords.top > 0 && coords.top < windowHeight;
      let bottomVisible = coords.bottom < windowHeight && coords.bottom > 0;

      return topVisible || bottomVisible;
    }

    

    function showVisible() {
      for (let img of document.querySelectorAll('img')) {
        let realSrc = img.dataset.src;
        if (!realSrc) continue;

        if (isVisible(img)) {
          

          img.src = realSrc;

          img.dataset.src = '';
        }
      }
      if ( Array.from(document.querySelectorAll('[data-src]')).every(
        img => img.getAttribute('data-src') === '') ) {
        window.removeEventListener('scroll', showVisible)
      }

    }

    window.addEventListener('scroll', showVisible);
    showVisible();
  </script>


    
    
      <div class="progress-container" id="scrollbar">
        <div class="progress-bar" id="progress-bar"></div>
      </div>  


    
<script>

window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  <!-- TOC -->
    
    <!-- cookie bar -->
    
<!-- Back to top -->
    
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        document.getElementById("backtotop").style.display = "block";
    } else {
        document.getElementById("backtotop").style.display = "none";
    }
    
    <!-- scroll indicator -->
    
      var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      var scrolled = (winScroll / height) * 100;
      document.getElementById("progress-bar").style.width = scrolled + "%";
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("scrollbar").style.display = "block";
        } else {
            document.getElementById("scrollbar").style.display = "none";
        }
    

    

    <!-- allowads -->
    
       if (document.body.scrollTop > 2000 || document.documentElement.scrollTop > 2000) {
          detectads();
       } 

    
}


</script>



  

</body>
</html>
