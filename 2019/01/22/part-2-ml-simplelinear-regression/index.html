
<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.53" />

    
    
    

<title>Part 2 Machine Learning Simplelinear Regression • A Morsel Of Code</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Part 2 Machine Learning Simplelinear Regression"/>
<meta name="twitter:description" content="Machine learning tutorial on Data preprocessing"/>

<meta property="og:title" content="Part 2 Machine Learning Simplelinear Regression" />
<meta property="og:description" content="Machine learning tutorial on Data preprocessing" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2019/01/22/part-2-ml-simplelinear-regression/" /><meta property="article:published_time" content="2019-01-22T21:41:47-05:00"/>
<meta property="article:modified_time" content="2019-01-22T21:41:47-05:00"/>



<link rel="canonical" href="/2019/01/22/part-2-ml-simplelinear-regression/" />

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">





<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">

<link rel="stylesheet" href="/css/w3.css" />


<link rel="stylesheet" href="/css/style.css" />







  
  
</head>
<body }

class="w3-light-grey">



    <header id="header">
      
          
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-47631412-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-47631412-1');
</script>

<div class="w3-right ">
<div class="w3-bar w3-light-grey  ">
  
  <span class="w3-bar-item w3-left " id="google_translate_element"></span>
<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement(
      {
          pageLanguage: 'en'
        , layout: google.translate.TranslateElement.FloatPosition.TOP_RIGHT
        , multilanguagePage: true
      }
      , 'google_translate_element'
    );
  }
</script>
<script async src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>


  
       <a href="javascript:void(0)" class="w3-bar-item w3-button w3-hover-green" title="Search" onclick="displaysearch()"><i class="fa fa-search"></i></a>
  
      <span class="w3-hide-small">

        <a href="mailto:dinesh19aug@gmail.com" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-envelope"></i></a>

        <a href="https://stackoverflow.com/users/1172194/dinesh-arora" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-stack-overflow"></i></a>

        <a href="https://twitter.com/dinesh19aug" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-twitter"></i></a>

        <a href="https://github.com/dinesh19aug" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-github"></i></a>

        <a href="https://www.linkedin.com/in/dinesharora" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-linkedin"></i></a>

        <a href="https://github.com/dinesh19aug" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-github"></i></a>

      </span>

</div>
</div>
<br>
  <div class="w3-content">

  <div class="w3-container w3-center w3-padding-32 w3-hide-small">
      <h1 class="w3-xxxlarge w3-text-blue w3-wide w3-allerta  " style="text-shadow:1px 1px 0 #444" ><u>
      
         A Morsel Of Code - One Byte At A Time
      
</u></h1>

    </div>
    <div class="w3-content w3-center">
    <div class="w3-bar w3-light-grey w3-border">
    <a href="/" class="w3-bar-item w3-button w3-large w3-green"><i class="fa fa-home"></i></a>
    
      <a href="/categories/" class="w3-bar-item w3-button w3-hide-small">Categories</a>
    
      <a href="/tags/" class="w3-bar-item w3-button w3-hide-small">Tags</a>
    


    <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="displaymenu()">&#9776;</a>
  </div>

<div id="mobilemenu" class="w3-bar-block w3-light-grey w3-hide w3-hide-large w3-hide-medium">
  
      <a href="/categories/" class="w3-bar-item w3-button">Categories</a>
      
      <a href="/tags/" class="w3-bar-item w3-button">Tags</a>
      

</div>
</div>
</div>
<script>
function displaymenu() {
    var x = document.getElementById("mobilemenu");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>



  <div id="searchOverlay" class="overlay w3-hide">
    <span class="closebtn" onclick="displaysearch()" title="Close Overlay">×</span>
    <div class="overlay-content">
        <form action="/search/">
          <input type="text" placeholder="Search.." name="q">
          <button type="submit"><i class="fa fa-search"></i></button>
        </form>
    </div>
  </div>

  <script>
  function displaysearch() {
    var x = document.getElementById("searchOverlay");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }

  }


  </script>





    <hr class="headfoot">

      
    </header>

<div class="w3-content">

      <div>
        <div id="content" >
          
    

      <div id="toc" class="w3-dropdown-hover w3-hide-small w3-hide-medium">
    <button class="w3-button w3-teal w3-xlarge">&#9776;</button>
    <div class="w3-dropdown-content w3-bar-block w3-border" style="right:0">
         
          <h3 class="w3-center">Contents </h3>
            <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#getting-the-dataset">Getting the dataset</a></li>
<li><a href="#what-is-simple-linear-regression">What is Simple Linear regression?</a></li>
<li><a href="#how-is-a-trendline-determined-by-a-model">How is a trendline determined by a model?</a></li>
<li><a href="#steps-to-solve-the-problem">Steps to solve the problem.</a>
<ul>
<li><a href="#plot-vs-scatter">Plot vs Scatter</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
         
      </div>

     
      </div>
    

 
     


  <div class="w3-content w3-card-4" >
    
    <header class="w3-container w3-center w3-padding-32">
      <h1>Part 2 Machine Learning Simplelinear Regression</h1>

      <div >
        <p> 2019-01-22 
          
             <code> 928 words  </code>
             <code> 5 mins read </code>
          
        </p>
        <div >
            
              <a class="w3-btn w3-small w3-round w3-green" href="/categories/tech-notes/"> Tech Notes </a>
            
          </div>
       
        
      </div>
    </header>

   
    
    <div class="w3-container">
      
        

        
        

        
          
          
          

<p>In the <a href="http://javahabit.com/2019/01/21/part-1-ml-data-preprocessing/">previous post</a> we learned about data pre-processing. In this post we will review the simplest algorithm - Simple Linear Regression.</p>

<p><strong>Business Problem</strong>: In this series, we are going to learn about Simple Linear Regression. We will review a data set about <code>Salary</code> and <code>Experience in age</code>. As a data scientist, your job is to help the HR department  predict the salary of a person based on his years of experience if he or she accepts the job offer. If you offer too low, the person will not accept the job offer. If you offer too high, then you will be wasting the company&rsquo;s resources($$).</p>

<h3 id="getting-the-dataset">Getting the dataset</h3>

<ol>
<li><a href="https://github.com/dinesh19aug/ml-notes/blob/master/Part-2-linear-regression/simple-linear-regression.ipynb">Jupyter Notebook &amp; images</a></li>
<li><a href="https://github.com/dinesh19aug/ml-notes/blob/master/Part-2-linear-regression/Salary_Data.csv">Simple Regression</a></li>
</ol>

<h3 id="what-is-simple-linear-regression">What is Simple Linear regression?</h3>

<p><img src="/placeholder.svg" data-src="/resources/img/slr-intro.PNG" alt="slr-intro.PNG" /></p>

<p>If we draw a graph of <code>salary</code> vs <code>Experience</code>, you will see a linear trend.
<img src="/placeholder.svg" data-src="/resources/img/linearGraph.PNG" alt="linearGraph" /></p>

<p>Based on the graph, it is clear that this is a positive slope. If the co-efficient <code>b1</code> is big, the slope is going to steeper, which means that if there is a small increase in the age, then there will be a big increase in the salary. If the value of <code>b1</code> is small, the slope is going to be more gentle and with change is experience, the salary is going to increase gently.</p>

<h3 id="how-is-a-trendline-determined-by-a-model">How is a trendline determined by a model?</h3>

<p>The model tries to find the trendline by determining the least of <code>Sum of errors</code>. In the below diagram, imagine the <code>red cross</code> as observed value and <code>green cross</code> as determined value(model prediction). The algorithm finds the difference between the and squares them. The algorithm does this for all the observed values and determines the slope of trendline which given the minimum of <strong>SUM(y - y<sup>^</sup>)<sup>2</sup></strong></p>

<p><img src="/placeholder.svg" data-src="/resources/img/trendline.PNG" alt="trendline" /></p>

<h3 id="steps-to-solve-the-problem">Steps to solve the problem.</h3>

<ul>
<li><strong>Step 1: Data Preprocessing</strong></li>
</ul>

<p>We will follow the same process as we did in the first series. We will import the libraries and read the csv file and take a look at the data.
<img src="/placeholder.svg" data-src="/resources/img/dataset.PNG" alt="dataset" /></p>

<pre><code class="language-python"># Importing the libraries
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

# Importing the dataset
dataset = pd.read_csv('../Salary_Data.csv')
X = dataset.iloc[:, :-1].values
y = dataset.iloc[:, 1].values
</code></pre>

<ul>
<li><p><strong>Step 2: Split the data into training and test data</strong></p>

<p>Since there are 30 rows, we will divide the data in 20:10(training:test)</p></li>
</ul>

<pre><code class="language-python">#Split the data into training and test data
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=1/3, random_state=0)
</code></pre>

<p><img src="/placeholder.svg" data-src="/resources/img/data-split.PNG" alt="data-split.PNG" /></p>

<ul>
<li><p><strong>Step 3: Feature Scaling</strong>
We won&rsquo;t be feature scaling or normalizing here because the library that will execute the model takes care of it. So we are going to skip this step.</p></li>

<li><p><strong>Step 4: Train the model</strong>
At this point our data pre-processing is complete and we will use the library to run the regression on the training data set.</p></li>
</ul>

<pre><code class="language-python">#Fittiing the Simple linear regression on the training set
from sklearn.linear_model import LinearRegression
regressor = LinearRegression( )
regressor.fit(X_train, y_train)
</code></pre>

<pre><code>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None,
         normalize=False)
</code></pre>

<p>In the above code, we have trained our model and saved it in the variable <code>regressor</code>.</p>

<ul>
<li><strong>Step 5: Predict and compare with the actual test set</strong></li>
</ul>

<p>Next, we are going to predict the values of the test sample and get the predicted results in variable <code>y_pred</code>.</p>

<pre><code class="language-python"># Predicting the salary of the test sample
y_pred = regressor.predict(X_test)
</code></pre>

<p>Let&rsquo;s see how did the model predict.
<img src="/placeholder.svg" data-src="/resources/img/predicted.PNG" alt="predicted" /></p>

<ul>
<li><strong>Step 5: Plot the data</strong></li>
</ul>

<p>To better understand, let&rsquo;s create plot the trendline of our model and look for two things
1. What is the fit of trendline for training data?
2. What is the fit of trendline on test data against predicted values?</p>

<pre><code class="language-python">plt.scatter(X_train, y_train, color='red')
plt.plot(X_train, regressor.predict(X_train), color='blue')
plt.title('Salary vs Experience (Training Set)')
plt.xlabel('Years of Experience')
plt.ylabel('Salary')
plt.show()

</code></pre>

<p><img src="/placeholder.svg" data-src="/resources/img/simple-linear-regression_files/simple-linear-regression_11_0.png" alt="png" /></p>

<p>Here&rsquo;s how the graph would like for <strong>Training data</strong>
<img src="/placeholder.svg" data-src="/resources/img/trainingPlot.PNG" alt="trainingPlot.PNG" />
Couple of things to note. The scatter function just plots the x,y values on the graph as red dots
&gt; plt.scatter(X_train, y_train, color=&lsquo;red&rsquo;)</p>

<p>The plot function also maps the data as blue dots but it joins them via line starting from first mapping to the last. Additionally, you will also notice that in the y-axis, we have passed model function <code>predict(X_train)</code> and <strong>not</strong>  <code>predict(x_test)</code> because we want to use the function created using the training set - <code>y=mx+c</code>.
&gt; plt.plot(X_train, regressor.predict(X_train), color=&lsquo;blue&rsquo;)</p>

<h4 id="plot-vs-scatter">Plot vs Scatter</h4>

<p>The primary difference of plt.scatter from plt.plot is that it can be used to create scatter plots where the properties of each individual point (size, face color, edge color, etc.) can be individually controlled or mapped to data.</p>

<p>The purpose of the above code is to show trendline against the training data points(red dots). If we wanted to show predicted line as set plotted <code>dots</code>, we would have used
&gt;plt.scatter(X_train, regressor.predict(X_train), color=&lsquo;blue&rsquo;)</p>

<p>In that case the graph would have looked like this.
<img src="/placeholder.svg" data-src="/resources/img/plot-cs-scatter.PNG" alt="plot-cs-scatter.PNG" /></p>

<p>Here&rsquo;s how the graph would like for <strong>Test data</strong></p>

<pre><code class="language-python">#Plot the data against test set
plt.scatter(X_test, y_test, color='red')
plt.plot(X_train, regressor.predict(X_train), color='blue')
plt.title('Salary vs Experience (Test Set)')
plt.xlabel('Years of Experience')
plt.ylabel('Salary')
plt.show()

</code></pre>

<p><img src="/placeholder.svg" data-src="/resources/img/simple-linear-regression_files/simple-linear-regression_13_0.png" alt="png" /></p>

<p><img src="/placeholder.svg" data-src="/resources/img/trendline_test.PNG" alt="trendline_test.PNG" />
As explained earlier, the trend line is what the model was trained against the training data set. Hence
&gt; plt.plot(X_train, regressor.predict(X_train), color=&lsquo;blue&rsquo;)</p>

<p>and <strong>not</strong>
&gt; plt.plot(X_test, regressor.predict(X_test), color=&lsquo;blue&rsquo;)</p>

<p>Now let&rsquo;s create a more complete picture -  the training set(RED DOTS), test set(GREEN DOTS) and predicted value (BLACK DOTS).</p>

<pre><code class="language-python">#Plot the data against test set
plt.scatter(X_train, y_train, color='red')
plt.scatter(X_test, y_test, color='green')
plt.scatter(X_test, y_pred, color='black')

plt.plot(X_train, regressor.predict(X_train), color='blue')
plt.title('Salary vs Experience (Test Set)')
plt.xlabel('Years of Experience')
plt.ylabel('Salary')
plt.show()
</code></pre>

<p><img src="/placeholder.svg" data-src="/resources/img/simple-linear-regression_files/simple-linear-regression_15_0.png" alt="png" /></p>

<p>So you will notice that all the <code>black</code> dots lie on the trend line because they are created using the trendline equation.</p>

<p>That&rsquo;s it. We just trained a model using Simple linear regression and predicted the values, then compared it against test data.</p>

<pre><code class="language-python">
</code></pre>

                 
                
         
      
    </div>

    
   

    <div class="w3-container">
    	
      
     
	</div>



  


    
    
    
    <div class="w3-container">
        
        <h2>Related Articles:</h2>
        <ul class="w3-ul w3-hoverable">
            
            

              <li class="w3-padding-large"><span class="date">2019/01/21</span> &nbsp; <a href="/2019/01/21/part-1-ml-data-preprocessing/">Part 1 Machine Learning Data Preprocessing</a></li>
            
        </ul>
    </div>
    
    
    <br>  
</div>



<div class="w3-container w3-card-2 w3-black">
<div class="w3-row">
  <div class="w3-col l2 m2 s12 w3-center">
  
    <img src="https://avatars3.githubusercontent.com/u/1176242?s=460&amp;v=4" width ="100px" class="w3-circle w3-center w3-margin-top w3-margin-bottom" alt="author" >
   
  </div>
  <div class="w3-col l10 m10 s12 ">
  <div class = "w3-container w3-margin-top">
    
    
  </div>
  </div>
  </div>
</div>

      
    <div class="w3-content" > 
      <div class="w3-bar w3-section">
	     
	    
	      <a class="w3-btn w3-right w3-text-indigo w3-hover-green" href="/2019/01/21/part-1-ml-data-preprocessing/">
	       Part 1 Machine Learning Data Preprocessing &#10095;
	      </a>
  	  </div>
    </div>
	
 

  
  
  

      <div id="wrapads">
        <div class="adBanner">
         
        </div>
       </div>
      
      <div id="allowads" class="allowads-overlay">
  
        <div class="allowads-overlay-content">
        <div class="w3-panel w3-pink w3-large">
        

         <p> We notice you're using an adblocker.  If you like our webite please keep us running by whitelisting this site in your ad blocker. We’re serving quality, related ads only. Thank you!</p>
         
          <div class="w3-btn w3-green"  onclick="closeOverlay()">I've whitelisted your website.</div><br>
          <div class="w3-button w3-small"  onclick="closeOverlay()">Not now</div>
        </div>
        </div>
      </div>

      <script>
      function closeOverlay() {
        document.getElementById("allowads").style.width = "0%";
        document.getElementById("wrapads").style.height="1px";
      }

      function detectads() {
      var h = document.getElementById("wrapads").clientHeight;

      if (h==0){ document.getElementById("allowads").style.width = "100%";
      }
      }
      

     
      
      </script>
        </div>
        
          <script>
  shareurl=encodeURIComponent(location.protocol + '//' + location.host + location.pathname);
  sharetitle=encodeURIComponent(document.title);
    
  </script>
<div class="icon-bar">
<script>
document.write( '<a href="javascript:bookmark();" class="bookmark w3-tooltip"><i class="fa fa-bookmark"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green ">Bookmark this page</span></a> ');

document.write( '<a href="http://www.facebook.com/sharer.php?u='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="facebook w3-tooltip"><i class="fa fa-facebook "></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Facebook</span></a> ');

document.write( '<a href="https://twitter.com/share?url='+shareurl+'&amp;text='+sharetitle+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="twitter w3-tooltip"><i class="fa fa-twitter"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Twitter</span></a> ');
document.write( '<a href="https://plus.google.com/share?url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="google w3-tooltip"><i class="fa fa-google"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Google Plus</span></a>');

document.write( '<a href="http://www.linkedin.com/shareArticle?mini=true&amp;url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="linkedin w3-tooltip"><i class="fa fa-linkedin"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Linkedin</span></a>');

</script>

<script>
function bookmark(){

if ('sidebar' in window && 'addPanel' in window.sidebar) { 
                window.sidebar.addPanel(location.href,document.title,"");
            } else if(  false) { 
                window.external.AddFavorite(location.href,document.title); 
            } else { 
                alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
            }
        }

</script>
</div>
        
        
          
  

        

      </div>



    <footer id="footer" >
      <div class="w3-container w3-center w3-padding-32"> 
  
  <hr class="headfoot">
  <p>Powered by <a href="https://gohugo.io">Hugo</a> | Theme - <a href="https://github.com/jesselau76/hugo-w3-simple">Hugo W3 Simple</a>
  </p>
  &copy; <a href="http://javahabit.com">Dinesh Arora</a> 2019 | <a href="https://github.com/dinesh19aug">Github</a> | <a href="https://twitter.com/dinesh19aug">Twitter</a>  | <a href="/index.xml">RSS</a>
  
</div>

    </footer>



  </div>

  

  
    
      <div id="backtotop" class="w3-hide-small w3-hide-medium">

        <button onclick="topFunction()" class="w3-btn w3-red w3-large" style="width:160px">Back To Top
        &rarr;</button>

      </div>

      <script>
        function topFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
      }
      </script>


    
 
    
    <script>

    function isVisible(elem) {

      let coords = elem.getBoundingClientRect();

      let windowHeight = document.documentElement.clientHeight;

      
      let topVisible = coords.top > 0 && coords.top < windowHeight;
      let bottomVisible = coords.bottom < windowHeight && coords.bottom > 0;

      return topVisible || bottomVisible;
    }



    function showVisible() {
      for (let img of document.querySelectorAll('img')) {
        let realSrc = img.dataset.src;
        if (!realSrc) continue;

        if (isVisible(img)) {


          img.src = realSrc;

          img.dataset.src = '';
        }
      }
      if ( Array.from(document.querySelectorAll('[data-src]')).every(
        img => img.getAttribute('data-src') === '') ) {
        window.removeEventListener('scroll', showVisible)
      }

    }

    window.addEventListener('scroll', showVisible);
    showVisible();
  </script>


    
    
      <div class="progress-container" id="scrollbar">
        <div class="progress-bar" id="progress-bar"></div>
      </div>


    
<script>

window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  <!-- TOC -->
    

    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        document.getElementById("toc").style.display = "block";
    } else {
        document.getElementById("toc").style.display = "none";
    }
    
    <!-- cookie bar -->
    
<!-- Back to top -->
    
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        document.getElementById("backtotop").style.display = "block";
    } else {
        document.getElementById("backtotop").style.display = "none";
    }
    
    <!-- scroll indicator -->
    
      var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      var scrolled = (winScroll / height) * 100;
      document.getElementById("progress-bar").style.width = scrolled + "%";
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("scrollbar").style.display = "block";
        } else {
            document.getElementById("scrollbar").style.display = "none";
        }


    

    <!-- allowads -->
    
       if (document.body.scrollTop > 2000 || document.documentElement.scrollTop > 2000) {
          detectads();
       }

    
}


</script>



  

</body>
</html>
